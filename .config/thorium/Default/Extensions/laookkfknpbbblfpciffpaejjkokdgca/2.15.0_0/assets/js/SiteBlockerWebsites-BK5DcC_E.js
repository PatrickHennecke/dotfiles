import{a as e,z as t,r as i}from"./ResizeSensor-CXS_pGRc.js";import{B as o}from"./BaseIcon-CACrCBea.js";import{a as s,A as r,b as n}from"./AppHeader-DGqF8Ifm.js";import{A as a}from"./AppView-CyOtvy2t.js";import{A as p}from"./AppHeaderControl-BC-AHodD.js";import{S as l}from"./siteBlockerViewState-BRcSSYc9.js";import{a as c,u as m,S as u}from"./siteBlockerGroups-1V1XRNi6.js";import{F as d}from"./FormEditableInlineInput-ByfGai0r.js";import{B as w}from"./BaseDropdown-BAkdZe-R.js";import{B as b}from"./BaseDropdownOption-CckvXbkm.js";import{B as f}from"./BaseItemList-DEa4hADS.js";import{T as h}from"./ToggleSwitch-PS_qhS7h.js";import{F as v}from"./FavIcon-Cddzo7ot.js";import{B as j}from"./BaseForm-C8SO80Dz.js";import{c as S}from"./preload-helper-D7CfCCEq.js";import{A as g,a as y}from"./AppConfirmCancel-Wgs8gVfQ.js";import{n as k}from"./promisifiedChrome-CheD9WtZ.js";import{A as I}from"./AppEmpty-BrSPSkb0.js";import"./environmentVariables-Cy83xda0.js";import"./arrow-B0GpGOd-.js";import"./icon-weather-reset-D7qA-OAP.js";import"./icon-settings-Bycjf8-G.js";import"./dashboard-CF_jRhAY.js";import"./main--IJuvtTE.js";import"./localStorage-B4mFdj8F.js";import"./Logger-Dqn8sDPg.js";import"./migrateLegacyUserMessageHandler-CU6TUnqH.js";import"./timestampDb-sTUCijT1.js";import"./icon-chrome-BdhFuvxf.js";import"./icon-back-arrow-CiRQJ6G-.js";import"./icon-back-D_TFrgyJ.js";import"./icon-check-Vc9B11BJ.js";import"./icon-circle-D-D5U4qS.js";import"./icon-close-BUGl_M7j.js";import"./icon-cog-BFr_Pva7.js";import"./icon-skip-BOkC5L0N.js";import"./icon-trash-DFxJwJNo.js";import"./icon-down-BiHbKN-t.js";import"./icon-edit-CixeXNYx.js";import"./icon-ellipsis-D3jS4u3x.js";import"./icon-error-state-BKQhfBCj.js";import"./icon-heart-v5O7C6eS.js";import"./icon-hide-NFfBhfBx.js";import"./icon-key-BPNRipb3.js";import"./icon-lock-B0ekkj2F.js";import"./icon-next-B4hjdiAA.js";import"./icon-photo-BrwqV1T0.js";import"./icon-pin-BHeOuzvO.js";import"./icon-plus-D4YOesIc.js";import"./icon-profile-B_XWyuTb.js";import"./icon-x-qUCmf2CW.js";import"./icon-skip-intro-BUi8b3Ak.js";import"./icon-tooltip-CN09iXOB.js";import"./icon-visible-on-CM3kpcFN.js";import"./icon-x-caret-half-CZtcH_PM.js";import"./star-rating-CNohptmf.js";import"./pomodoro-circle-Dx_GWql1.js";import"./star-KworSO8x.js";import"./thanks-DfYnO-qW.js";import"./add-COIuonao.js";import"./google-DKPAcOmk.js";import"./arrow-up-1QPpu78M.js";import"./chevron-down-DdbU9YAr.js";import"./pomodoro-DvfTwCi0.js";import"./clocks-DjzskNOU.js";import"./close-D7GCNZxm.js";import"./search-DCqlmJx6.js";import"./folder-CwWTWsnJ.js";import"./switch-EuBTQVVE.js";import"./focus-mode-09pIyYAW.js";import"./storage-YYEO5TB5.js";import"./icon-confetti-Dz2LojDe.js";import"./wind-D3u4taeq.js";import"./sparks-CAw9b6ob.js";import"./secure-B8YP-AML.js";import"./icon-percent-schedule-CA5EI9b7.js";import"./icon-trello-BoqqWb7o.js";import"./icon-clean-rFsPxTtp.js";import"./icon-more-lists-Dg-hN7s6.js";import"./icon-more-fonts-CcfOY0t4.js";import"./icon-focus-stats-keERwXFt.js";import"./icon-easy-access-BZifTR0C.js";import"./icon-top-of-mind-B6EhbCcK.js";import"./icon-flow-5QqmGIWX.js";import"./icon-focused-JrsBbR-K.js";import"./icon-weather-extra-ufLpT_SX.js";import"./icon-spiral-gh4hwZDD.js";import"./icon-happy-place-D1z6CJgM.js";import"./icon-time-sensitive-CP2L3maw.js";import"./icon-hourly-CdMmiQZT.js";import"./icon-infinity-D4yMRoAd.js";import"./icon-integrations-Y-aXZTst.js";import"./icon-kanban-Dodqg7y-.js";import"./icon-personalize-photos-D2M4lLlt.js";import"./icon-personalize-n8qjJGGA.js";import"./icon-photo-match-C2EChNEK.js";import"./icon-random-375DbcwF.js";import"./icon-timezones-DGZoTtaT.js";import"./icon-simplify-BRUtLJYp.js";import"./icon-skip-Bd6EhalI.js";import"./icon-sync-DIH26Y9h.js";import"./ViewState-CkTFc_ep.js";import"./constants-D-OQQ8lR.js";import"./compareObjects-BF7sSNEf.js";import"./globalKeyEventManager-KbJZwtdf.js";import"./VueBase-CjPGMLuv.js";import"./index-CJJH83pl.js";import"./constants-BpVlFj04.js";import"./allComponentsMounted-C3UsG_cA.js";import"./FormMessage-DG-NAWke.js";import"./SmoothReflow-B3dWZqEj.js";import"./string-KTo4Qfpe.js";const C=k(e({name:"BaseDropdownConfirmation",components:{AppConfirmCancel:g},props:y,emits:["cancel","delete"],setup:()=>({AppConfirmCancelType:s})}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("app-confirm-cancel",e._g(e._b({attrs:{"data-test":"dropdown-confirm-delete"}},"app-confirm-cancel",e.$props,!1),e.$listeners))],1)}),[],!1,null,"7f4cb52f").exports,A=e({name:"SiteBlockerWebsitesListItem",components:{BaseDropdownConfirmation:C,FormEditableInlineInput:d,BaseForm:j,FavIcon:v,BaseIcon:o,BaseDropdownOption:b,BaseDropdown:w,ToggleSwitch:h},props:{website:{type:Object,required:!0},editing:{type:Boolean,default:!1},newWebsite:{type:Boolean,default:!1}},setup:()=>({viewStateStore:t("viewStateStore"),websitesStore:c(),websitesDropdownRef:i(),inputNameRef:i(),inputUrlRef:i(),capture:t("capture")}),computed:{urlNameIfEmpty(){var e,t;if(this.website.name)return this.website.name;const i=null==(t=null==(e=this.website.url)?void 0:e.split("."))?void 0:t.at(-2);return i&&i.length>4&&S(i)||""},namePlaceholder(){return""===this.website.url||""===this.urlNameIfEmpty?"Website Name":this.urlNameIfEmpty},dropdownConfirmationVisible(){var e,t;return(null==(t=null==(e=this.viewStateStore)?void 0:e.confirmationProps)?void 0:t.type)===s.Dropdown}},mounted(){var e;this.newWebsite&&(null==(e=this.inputUrlRef)||e.focus())},methods:{toggleEnabled(){var e;if(this.website.enabled=!this.website.enabled,!this.newWebsite)return null==(e=this.capture)||e.call(this,"site blocker toggle website"),this.websitesStore.update(this.website.id,{enabled:this.website.enabled})},async editWebsite(e){var t,i,o,r,n;(!this.websitesStore.activeItem||!this.editing&&await(null==(t=this.viewStateStore)?void 0:t.setConfirmation({title:"Are you sure you want to edit?",description:"All unsaved changes will be lost!",type:s.Dropdown})))&&(null==(i=this.capture)||i.call(this,"site blocker edit website",{defaultKey:this.website.defaultKey}),this.websitesStore.editItem(this.website.id)),null==(o=this.websitesDropdownRef)||o.closeDropdown(),await this.$nextTick(),e?null==(r=this.inputNameRef)||r.focus():null==(n=this.inputUrlRef)||n.focus()},async deleteWebsite(){var e,t,i,o;await(null==(e=this.viewStateStore)?void 0:e.setConfirmation({title:"Are you sure you want to delete?",type:s.Dropdown}))&&(null==(t=this.websitesDropdownRef)||t.closeDropdown(),await this.websitesStore.delete(this.website.id),null==(i=this.capture)||i.call(this,"site blocker delete website",{defaultKey:this.website.defaultKey}),(null==(o=this.websitesStore.activeItem)?void 0:o.id)===this.website.id&&this.websitesStore.clearActiveItem())},validateWebsite(){this.website.name=this.urlNameIfEmpty,this.website.validate()},async createNewWebsiteOrUpdateIfNameUrl(){var e,t;if(this.editing)return this.websitesStore.clearActiveItem(),this.newWebsite?(null==(e=this.capture)||e.call(this,"site blocker create website",{defaultKey:this.website.defaultKey}),this.websitesStore.create(this.website)):(null==(t=this.capture)||t.call(this,"site blocker update website",{defaultKey:this.website.defaultKey}),this.websitesStore.update(this.website.id,{name:this.website.name,url:this.website.url}))},clearConfirmationIfOpen(e){this.viewStateStore&&e&&(this.viewStateStore.confirmationProps=null)}}});const B=e({name:"SiteBlockerWebsitesList",components:{SiteBlockerWebsitesListItem:k(A,(function(){var e,t,i=this,o=i._self._c;return i._self._setupProxy,o("li",{staticClass:"site-blocker-websites-list-item app-list-item-lines-between",attrs:{"data-test":"websites-list-item"}},[o("base-form",{staticClass:"list-item-form",class:{editing:i.editing},attrs:{submit:i.createNewWebsiteOrUpdateIfNameUrl,validate:i.validateWebsite,"submit-button":!1,"submit-on-blur":!0}},[o("div",{staticClass:"list-item-top-row"},[i.editing?i._e():o("fav-icon",{staticClass:"url-favicon",attrs:{url:i.website.urlWithReplacedWildcard}}),o("form-editable-inline-input",{ref:"inputNameRef",staticClass:"name-input",attrs:{editing:i.editing,name:"name-input",placeholder:i.namePlaceholder,"data-test":"websites-list-item-name-input"},nativeOn:{dblclick:function(e){return i.editWebsite(!0)}},model:{value:i.website.name,callback:function(e){i.$set(i.website,"name",e)},expression:"website.name"}}),o("toggle-switch",{attrs:{value:i.website.enabled,"data-test":"websites-list-item-toggle"},on:{click:i.toggleEnabled}}),o("base-dropdown",{ref:"websitesDropdownRef",attrs:{"data-test":"website-options-dropdown"},on:{toggle:i.clearConfirmationIfOpen}},[i.dropdownConfirmationVisible&&(null==(e=i.viewStateStore)?void 0:e.confirmationProps)?o("base-dropdown-confirmation",i._b({},"base-dropdown-confirmation",null==(t=i.viewStateStore)?void 0:t.confirmationProps,!1)):[o("base-dropdown-option",{attrs:{"data-test":"edit-website"},on:{click:function(e){return i.editWebsite(!1)}}},[o("base-icon",{staticClass:"icon",attrs:{src:"icon-edit"}}),i._v(" Edit ")],1),o("base-dropdown-option",{attrs:{"data-test":"delete-website"},on:{click:i.deleteWebsite}},[o("base-icon",{staticClass:"icon",attrs:{src:"icon/delete"}}),i._v(" Delete ")],1)]],2)],1),o("div",{staticClass:"list-item-bottom-row"},[o("form-editable-inline-input",{ref:"inputUrlRef",staticClass:"url-input",attrs:{editing:i.editing,name:"url-input",placeholder:"URL","data-test":"websites-list-item-url-input"},nativeOn:{dblclick:function(e){return i.editWebsite(!1)}},model:{value:i.website.url,callback:function(e){i.$set(i.website,"url",e)},expression:"website.url"}})],1)])],1)}),[],!1,null,"bdce6952").exports,BaseItemList:f},setup:()=>({websitesStore:c(),groupsStore:m()}),computed:{activeGroup(){return this.groupsStore.activeItem??new u({order:this.groupsStore.items.length})},websites(){return this.websitesStore.getWebsitesByGroup(this.activeGroup)},editingExistingWebsite(){return!!this.websitesStore.activeItem&&!!this.websitesStore.getWebsiteOrDefaultFromId(this.websitesStore.activeItem.id)}},methods:{createNewWebsite(){this.websitesStore.newItem(this.activeGroup)}}});const G=k(e({name:"SiteBlockerWebsites",components:{BaseDropdownConfirmation:C,BaseForm:j,AppEmpty:I,AppConfirmCancel:g,SiteBlockerWebsitesList:k(B,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("base-item-list",[e.websitesStore.activeItem&&!e.editingExistingWebsite?t("site-blocker-websites-list-item",{key:e.websitesStore.activeItem.id,attrs:{website:e.websitesStore.activeItem,editing:!0,"new-website":!0}}):e._e(),e._l(e.websites,(function(i){var o,s;return t("site-blocker-websites-list-item",{key:i.id,attrs:{website:(null==(o=e.websitesStore.activeItem)?void 0:o.id)===i.id?e.websitesStore.activeItem:i,editing:(null==(s=e.websitesStore.activeItem)?void 0:s.id)===i.id}})}))],2)}),[],!1,null,null).exports,BaseDropdownOption:b,BaseDropdown:w,FormEditableInlineInput:d,AppHeaderControl:p,AppView:a,AppHeader:r,BaseIcon:o},setup:()=>({viewStateStore:t("viewStateStore"),groupsStore:m(),websitesStore:c(),nameInputRef:i(),groupDropdownRef:i(),capture:t("capture"),AppHeaderCenterAlignment:n}),data:()=>({editingGroupName:!1}),computed:{activeGroup(){return this.groupsStore.activeItem??new u({order:this.groupsStore.items.length})},hasActiveItem(){return!!this.websitesStore.activeItem},empty(){return 0===this.websitesStore.getWebsitesByGroup(this.activeGroup).length},overlayConfirmationVisible(){var e,t;return(null==(t=null==(e=this.viewStateStore)?void 0:e.confirmationProps)?void 0:t.type)===s.Overlay},dropdownConfirmationVisible(){var e,t;return(null==(t=null==(e=this.viewStateStore)?void 0:e.confirmationProps)?void 0:t.type)===s.Dropdown}},mounted(){this.viewStateStore&&(this.viewStateStore.beforeViewChange=()=>(this.editingGroupName||this.websitesStore.activeItemHasChanges)&&this.viewStateStore?this.viewStateStore.setConfirmation({title:"Are you sure you want to cancel?",description:"All unsaved changes will be lost!",type:s.Overlay,dashboardOverlay:!0}):Promise.resolve(!0))},destroyed(){var e;null==(e=this.viewStateStore)||e.resetBeforeViewChange(),this.groupsStore.clearActiveItem(),this.websitesStore.clearActiveItem()},methods:{async goToGroups(){var e;await(null==(e=this.viewStateStore)?void 0:e.setActiveView(l.Groups))},createNewWebsite(){this.websitesStore.newItem(this.activeGroup)},async renameGroup(){var e,t;null==(e=this.groupDropdownRef)||e.closeDropdown(),this.editingGroupName=!0,await this.$nextTick(),null==(t=this.nameInputRef)||t.focus()},async deleteGroup(){var e,t,i;await(null==(e=this.viewStateStore)?void 0:e.setConfirmation({title:"Are you sure you want to delete this group?",type:s.Dropdown}))&&(null==(t=this.groupDropdownRef)||t.closeDropdown(),this.websitesStore.clearActiveItem(),null==(i=this.capture)||i.call(this,"site blocker delete group",{defaultKey:this.activeGroup.defaultKey}),await this.groupsStore.delete(this.activeGroup.id),await this.goToGroups())},updateGroupNameIfName(){var e;""!==this.activeGroup.name&&(this.editingGroupName=!1,null==(e=this.capture)||e.call(this,"site blocker update group",{defaultKey:this.activeGroup.defaultKey}),this.groupsStore.update(this.activeGroup.id,{name:this.activeGroup.name}))},clearConfirmationIfOpen(e){this.viewStateStore&&e&&(this.viewStateStore.confirmationProps=null)}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("app-view",{staticClass:"site-blocker-websites",scopedSlots:e._u([{key:"header",fn:function(){return[t("app-header",{scopedSlots:e._u([{key:"left",fn:function(){return[t("app-header-control",{on:{click:e.goToGroups}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon/arrow-left"}})],1),t("base-form",{staticClass:"group-name-form",attrs:{submit:e.updateGroupNameIfName,"submit-button":!1,"submit-on-blur":!0}},[t("form-editable-inline-input",{ref:"nameInputRef",staticClass:"name-input app-header-name",attrs:{placeholder:"Edit group",editing:e.editingGroupName,"data-test":"websites-group-name-input"},nativeOn:{dblclick:function(t){return e.renameGroup.apply(null,arguments)}},model:{value:e.activeGroup.name,callback:function(t){e.$set(e.activeGroup,"name",t)},expression:"activeGroup.name"}})],1)]},proxy:!0},{key:"right",fn:function(){var i,o;return[t("app-header-control",{attrs:{"data-test":"new-website"},on:{click:e.createNewWebsite}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon-plus"}})],1),t("base-dropdown",{ref:"groupDropdownRef",attrs:{"data-test":"group-options-dropdown"},on:{toggle:e.clearConfirmationIfOpen}},[e.dropdownConfirmationVisible&&(null==(i=e.viewStateStore)?void 0:i.confirmationProps)?t("base-dropdown-confirmation",e._b({},"base-dropdown-confirmation",null==(o=e.viewStateStore)?void 0:o.confirmationProps,!1)):[t("base-dropdown-option",{attrs:{"data-test":"edit-group"},on:{click:e.renameGroup}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon-edit"}}),e._v(" Rename ")],1),t("base-dropdown-option",{attrs:{"data-test":"delete-group"},on:{click:e.deleteGroup}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon/delete"}}),e._v(" Delete ")],1)]],2)]},proxy:!0}])})]},proxy:!0},{key:"body",fn:function(){return[e.empty&&!e.hasActiveItem?t("app-empty",{attrs:{description:"Add a website to get started","button-text":"Add Website","button-data-test":"new-website-empty"},on:{buttonClick:e.createNewWebsite}}):t("site-blocker-websites-list")]},proxy:!0},{key:"confirm",fn:function(){var i;return[e.overlayConfirmationVisible&&(null==(i=e.viewStateStore)?void 0:i.confirmationProps)?t("app-confirm-cancel",e._b({},"app-confirm-cancel",e.viewStateStore.confirmationProps,!1)):e._e()]},proxy:!0},{key:"footer",fn:function(){return[e._t("default")]},proxy:!0}],null,!0)})}),[],!1,null,"fc3c91ca").exports;export{G as default};