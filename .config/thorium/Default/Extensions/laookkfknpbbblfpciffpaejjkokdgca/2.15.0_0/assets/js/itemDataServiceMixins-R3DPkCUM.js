import{b as e,t}from"./promisifiedChrome-CheD9WtZ.js";import{M as r}from"./timestampDb-sTUCijT1.js";const s={mixins:[{methods:{_mergeQueryParams(...e){return Object.assign.apply(null,[{},this.queryParams.all||{}].concat(e))},_buildQueryString(...e){const t=new URLSearchParams(this._mergeQueryParams.apply(null,e)).toString();return t?"?"+t:""}}}],unreactive:()=>({type:"",path:"",mode:"sync",pathOverrides:{},queryParams:{get:{},update:{}}}),created(){this.type||console.error("dataSyncServiceMixin Error: You must declare a type in unreactive")},methods:{get({path:t=this.pathOverrides.get||this.path||this.type,success:s,failure:a,queryParams:i,mode:n=this.mode,retry:h,notifyUserOnFailure:d}={}){t+=this._buildQueryString(this.queryParams.get,i);const o=[this.type,{path:t,env:this._getEnv(),mode:n,retry:h,notifyUserOnFailure:d}],u=this.type+":refreshed";n===r.Server?e.sendMessage({handler:"get",args:o}).then(s).catch(a):e.sendRecurringCrossTabMessage({msgId:u,handler:"get",args:o,success:s,failure:a})},refresh({queryParams:e,retry:t,notifyUserOnFailure:s}={}){return new Promise(((a,i)=>{this.get({queryParams:e,retry:t,mode:r.Server,success:a,failure:i,notifyUserOnFailure:s})}))},add(t,r,{path:s=this.pathOverrides.add||this.path||this.type,mode:a=this.mode}={}){const i=[this.type,t,r,{path:s,mode:a,env:this._getEnv()}];return e.sendMessage({handler:"create",args:i})},update(t,r,{path:s=this.pathOverrides.update||this.path||this.type,mode:a=this.mode,queryParams:i}={}){const n=this._buildQueryString(this.queryParams.update,i),h=[this.type,t,r];return h.push({path:s,mode:a,env:this._getEnv(),queryString:n}),e.sendMessage({handler:"update",args:h})},delete(t,{path:r=this.pathOverrides.delete||this.path||this.type,mode:s=this.mode}={}){const a=[this.type,t,{path:r,mode:s,env:this._getEnv()}];return e.sendMessage({handler:"delete",args:a})},_getEnv:()=>({token:localStorage.getItem("token"),clientUuid:localStorage.getItem("client_uuid"),apiUrl:m.globals.urlRootApi,version:m.globals.version,tabId:t})}};export{s as d};