import{h as e}from"./handlebarLoader-xbtIzd6B.js";e({addin:"9c684606-8b84-49ed-bff3-6bb71bb3593b",dependencies:["settings"],commands:["settings.panels.focusmode"],id:"settings_focus_mode"},Object.assign({"./commands/panel.js":e=>{e.commands.SettingsPanelFocusMode=m.models.Command.extend({defaults:{id:"settings.panels.focusmode"},execute:function(){return e.styleLoaded||(e.styleLoaded=!0,e.styles.style()),new e.views.FocusMode}})},"./views/focusmode.js":e=>{var t=e.dependencies.settings;e.views.FocusMode=t.views.SettingsPanel.extend({attributes:{id:"settings-focus-mode",class:"settings-view settings-focus-mode","data-test":"settings-focus-mode"},template:e.templates.focusmode,panelid:"focus-mode",events:{"click .toggle-option":"toggleOption","click .slide-toggle":"toggleSlider","dblclick .slide-toggle":"eatDblClick",webkitAnimationEnd:"onAnimationEnd"},initialize:function(){this.model=m.models.customization,this.initializeCustomizeItems(),this.listenTo(this.model,"change",this.customizationModelChanged),m.Analytics.capture("settings panel show",{feature:"settings",name:"focus mode"})},initializeCustomizeItems:function(){this.customizeItems=[{name:"1-click focus",dataId:"settings-focus-mode-1-click-focus",field:"oneClickFocus",section:"customize",message:"Skip setup window"},{name:"Blur background",dataId:"settings-focus-mode-blur-background",field:"blurBackground",section:"customize"},{name:"Focused Metric",dataId:"settings-focus-mode-insight",field:"focusInsightVisible",section:"customize",message:"See how many minutes you've focused"},{name:"Links",dataId:"settings-focus-mode-links",field:"linksVisible",section:"widgets"},{name:"Metrics",dataId:"settings-focus-mode-metrics",field:"metricsVisible",section:"widgets",plusOnly:!0,requiredFeature:"plus"},{name:"Countdowns",dataId:"settings-focus-mode-countdowns",field:"countdownsVisible",section:"widgets",plusOnly:!0,requiredFeature:"plus"},{name:"World Clocks",dataId:"settings-focus-mode-world-clocks",field:"worldClocksVisible",section:"widgets",plusOnly:!0,requiredFeature:"plus"},{name:"Focus mantras",dataId:"settings-focus-mode-mantras",field:"mantrasVisible",section:"widgets",message:"Affirmations at the bottom that help you stay focused"},{name:"Ask AI",dataId:"settings-focus-mode-ask-ai",field:"askAiVisible",section:"widgets",plusOnly:!0,requiredFeature:"plus"},{name:"Notes",dataId:"settings-focus-mode-notes",field:"notesVisible",section:"widgets",plusOnly:!0,requiredFeature:"plus"}]},render:function(){var e=m.isLoggedIn();this.$el.html(this.template({loggedIn:e})),this.$popBody=this.$(".pop-body");var s={customize:this.$el.find("#customize-list"),widgets:this.$el.find("#apps-list"),misc:this.$el.find("#misc-list"),labs:this.$el.find("#labs-list")};_.each(s,(function(e){e.empty()}));var i=this;return _.each(this.customizeItems,(function(e){var n=Object.assign({},e);i.fieldHasOwnControl(e.field)&&(n.field=e.field.name),n.options?s[n.section].append(t.templates["general-toggle-options"](n)):s[n.section].append(t.templates["general-toggle-slider"](n))})),this.updateControlStates(),this},onAnimationEnd:function(e){m.utils.removePulseClass(e)},customizationModelChanged:function(e){e&&this.updateControlStates()},fieldHasOwnControl:function(e){return!("object"!=typeof e||null===e||!e.get||!e.set)},updateControlStates:function(){var e=_.pluck(this.customizeItems,"field"),t=this;_.each(e,(function(e){var s=t.findMatchingItem(e);if(s){var i=t.fieldHasOwnControl(e)?e.get():JSON.parse(t.model.getComputedSetting("focusModeSettingsStr"))[e];void 0===i&&(i=JSON.parse(m.models.customization.persistentSettings.defaultIfNotSet.focusModeSettingsStr)[e]);var n=t.getFieldName(e);if(s.options){t.$el.find("."+n).removeClass("active"),t.$el.find("."+n+"[data-option-value='"+i+"']").first().addClass("active")}else{i=!(s.plusOnly&&!t.featureAvailable(s.requiredFeature))&&!!i;var o=t.$el.find("[data-related-widget='"+n+"']");if(o&&1===o.length)o.first().toggleClass("on",i)}}}))},findMatchingItem:function(e){var t=this;return"object"==typeof e&&(e=e.name),this.customizeItems.find((function(s){return(t.fieldHasOwnControl(s.field)?s.field.name:s.field)===e}))},getFieldName:function(e){return this.fieldHasOwnControl(e)?e.name:e},scrollIntoView:function(e){var t=$(e),s=t.closest(".settings-view-container"),i=t.offset().top,n=s.offset().top;i-n-12<0&&s.animate({scrollTop:s[0].scrollTop+i-n-12})},featureAvailable:function(e){return m.conditionalFeatures.featureEnabled(e)||m.conditionalFeatures.featureEnabled(e+"-degraded")},toggleOption:function(e){var t=$(e.delegatedTarget);!0!==this.setOption(t)?m.trigger("globalEvent:settingsclick",e):e.stopImmediatePropagation()},setOption:function(e){var t=e.attr("data-related-widget"),s=e.attr("data-option-value"),i=this.findMatchingItem(t);if(!i)return null;this.$el.find("."+t).removeClass("active"),e.addClass("active");var n=JSON.parse(this.model.getComputedSetting("focusModeSettingsStr"));return n[t]=s,this.model.save({focusModeSettingsStr:JSON.stringify(n)}),m.Analytics.capture(i.name.toLowerCase()+" select",{new_value:s,location:"settings focus mode",feature:"focus mode"}),i},toggleSlider:function(e){if(!this.eatClicks){this.eatClicks=!0;var t=this;setTimeout((function(){t.eatClicks=!1}),250);var s=$(e.delegatedTarget).attr("data-related-widget"),i=this.findMatchingItem(s);if(!i.plusOnly||this.featureAvailable(i.requiredFeature)){if(!i.unsupported&&!i.options){if(s){var n,o=JSON.parse(this.model.getComputedSetting("focusModeSettingsStr")),a=o[s],d=JSON.parse(m.models.customization.persistentSettings.defaultIfNotSet.focusModeSettingsStr);void 0===a&&(a=d[s]),n=!a,o[s]=n,this.model.save({focusModeSettingsStr:JSON.stringify(o)}),(l=i).skipAnalyticsOnChange||m.Analytics.capture("feature "+(n?"enable":"disable"),{is_paid_event:!!l.plusOnly,feature:l.eventFeatureName||l.name.toLowerCase(),location:"settings focus mode"})}var l;m.trigger("globalEvent:settingsclick",e)}}else"Ask AI"===i.name?m.cmd("modal.open","UPSELL_AI_CHAT",{eventSource:"settings"}):"Countdowns"===i.name?m.cmd("modal.open","UPSELL_COUNTDOWNS",{eventSource:"settings"}):"Metrics"===i.name?m.cmd("modal.open","UPSELL_METRICS",{eventSource:"settings"}):"Notes"===i.name?m.cmd("modal.open","UPSELL_NOTES",{eventSource:"settings"}):"World Clocks"===i.name?m.cmd("modal.open","UPSELL_WORLD_CLOCKS",{eventSource:"settings"}):m.cmd("modal.open","PLUS_GATE",{eventSource:"settings"})}},isPlus:function(){return m.conditionalFeatures.featureEnabled("plus")},ensurePermissions:function(e,t,s,i){m.promisifiedChrome.permissions.contains(e).then((function(n){n?t(!0):m.cmd("modal.open","PERMISSION_REQUEST",{resolve:t,permissions:e,widgetName:s,permissionExplanation:i})}))}})}}),Object.assign({"./templates/focusmode.hbs":{compiler:[8,">= 4.3.0"],main:function(e,t,s,i,n){return'<header class="settings-header">\n\t<h3 data-test="general-header">Focus Mode</h3>\n\t<p class="description">Concentrate by eliminating distractions with timers and sounds</p>\n</header>\n\n<ul id="customize-list" class="settings-list options-list"></ul>\n\n<h4>Show during focus</h4>\n<ul id="apps-list" class="settings-list options-list"></ul>\n\n'},useData:!0}}),(()=>{}));