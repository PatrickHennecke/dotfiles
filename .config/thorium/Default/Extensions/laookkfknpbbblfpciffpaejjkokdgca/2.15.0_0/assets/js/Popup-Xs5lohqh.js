import{A as t}from"./AppPopup-D_ukOJBQ.js";import{_ as e}from"./icon-close-BUGl_M7j.js";import{_ as i}from"./chevron-down-DdbU9YAr.js";import{n as a}from"./promisifiedChrome-CheD9WtZ.js";const o=a({name:"Popup",components:{AppPopup:t},props:{id:{type:String,required:!0},targetElementSelector:{type:String,required:!0},elementReadyEvent:{type:String,default:""},position:{type:String,default:"top-right"},region:{type:String,default:"bottom-left"},appPopupClasses:{type:String,default:""},headerText:{type:String,default:""},bodyText:{type:String,default:""},ctaText:{type:String,default:"Learn moreâ€¦"},ctaCallback:{type:Function,default:null},ctaClasses:{type:String,default:""},secondaryText:{type:String,default:""},secondaryCallback:{type:Function,default:null},secondaryClasses:{type:String,default:""},hideCallback:{type:Function,default:null},nextButtonText:{type:String,default:"Next"},windowEdgePadding:{type:Number,default:7},targetDistance:{type:Number,default:0},pulseAnimation:{type:Boolean,default:!0},imageUrl:{type:String,default:""},notificationStyling:{type:Object,default:()=>{}},ctaTriggersComplete:{type:Boolean,default:!1},width:{type:Number,default:390},offset:{type:Number,default:0},nippleVisible:{type:Boolean,default:!0},nippleDisplacement:{type:Number,default:m.constants.nippleDisplacementPx},onPopupClicked:{type:Function,default:null},hidden:{type:Boolean,default:!0}},data:()=>({popupStyles:{},popupVisible:!1}),watch:{hidden:{async handler(){this.hidden||this.setPosition()},immediate:!0}},async mounted(){m.on("globalEvent:window:resize",this.handleResize),m.on("devPanelToggled",this.handleResize),m.on("popup:hide",this.hidePopup);const t=t=>{this.setPosition(t),this.popupVisible=!0},e=this.getTargetElement();e?t(e):this.elementReadyEvent?m.on(this.elementReadyEvent,t):this.$emit("error")},destroyed(){m.off("globalEvent:window:resize",this.handleResize),m.off("devPanelToggled",this.handleResize),m.off("popup:hide",this.hidePopup)},methods:{calculatePosition(t){try{const e=t.getBoundingClientRect(),i=document.querySelector(".dashboard").getBoundingClientRect();return{top:e.top+"px",right:e.right+"px",bottom:e.bottom+"px",left:e.left-i.left+"px",width:e.width+"px",height:e.height+"px",position:"absolute"}}catch(e){return this.$emit("error"),this.popupStyles}},setPosition(t=this.getTargetElement()){this.popupStyles=this.calculatePosition(t)},handleResize(t){!0===t?this.$nextTick(this.setPosition):(clearTimeout(this.timeout),this.timeout=setTimeout(this.setPosition,100))},clickCta(){this.ctaCallback&&this.ctaCallback(),this.ctaTriggersComplete&&this.completeStep()},clickSecondary(){this.secondaryCallback&&this.secondaryCallback()},completeStep(){this.$emit("stepComplete")},close(){this.hideCallback&&this.hideCallback(),this.$emit("dismiss")},getTargetElement(){return document.querySelector(this.targetElementSelector)},hidePopup(t){this.popupVisible=!t}}},(function(){var t=this,a=t._self._c;return a("div",{staticClass:"popup-base",class:{"popup-pulse":t.pulseAnimation,"notification-popup":t.notificationStyling},style:t.popupStyles},[a("transition",{attrs:{name:"fade-blurred-app",duration:200,appear:""}},[a("app-popup",{directives:[{name:"show",rawName:"v-show",value:t.popupVisible,expression:"popupVisible"}],class:[{"brand-full-override":!!t.notificationStyling},t.appPopupClasses],attrs:{"data-test":"popup","data-test-id":t.id,region:t.region,position:t.position,"svg-background":!t.notificationStyling,width:t.width,offset:t.targetDistance,"nipple-visible":t.nippleVisible,"nipple-displacement":t.nippleDisplacement}},[t.notificationStyling?a("div",{staticClass:"popup-highlight-bar"}):t._e(),t.imageUrl?a("div",{staticClass:"popup-image"},[a("img",{attrs:{src:t.imageUrl,alt:`${t.headerText} demonstration`}})]):t._e(),a("div",{staticClass:"icon-wrapper icon-wrapper-close popup-close",class:[{dark:t.notificationStyling&&t.imageUrl&&!t.notificationStyling.image_has_white_background,light:t.notificationStyling&&t.imageUrl&&t.notificationStyling.image_has_white_background}],attrs:{"data-test":"close"},on:{click:function(e){return e.stopPropagation(),t.close.apply(null,arguments)}}},[a("inline-svg",{staticClass:"icon icon-cancel",attrs:{src:e}})],1),a("div",{staticClass:"popup-content",class:{clickable:!!t.onPopupClicked},on:{click:function(e){var i;null==(i=t.onPopupClicked)||i.call(t)}}},[t.headerText?a("header",{staticClass:"popup-header"},[a("h3",{staticClass:"popup-title"},[t._v(t._s(t.headerText))])]):t._e(),a("div",{staticClass:"popup-body",attrs:{"data-test":"body-text"}},[t._v(t._s(t.bodyText))]),t.ctaCallback||t.secondaryCallback||t.ctaTriggersComplete?a("div",{staticClass:"popup-footer"},[a("div",{staticClass:"footer-button-row"},[t.ctaCallback||t.ctaTriggersComplete?a("span",{staticClass:"button button-primary",class:[t.ctaClasses],attrs:{"data-test":"cta"},on:{click:function(e){return e.stopPropagation(),t.clickCta.apply(null,arguments)}}},[t._v(" "+t._s(t.ctaText)+" "),t.notificationStyling?a("inline-svg",{staticClass:"icon notification-button-chevron",attrs:{src:i}}):t._e()],1):t._e(),t.secondaryCallback?a("span",{staticClass:"button-secondary",class:[t.secondaryClasses],attrs:{"data-test":"secondary"},on:{click:function(e){return e.stopPropagation(),t.clickSecondary.apply(null,arguments)}}},[t._v(" "+t._s(t.secondaryText)+" ")]):t._e()]),t._t("footer")],2):t._e()])])],1)],1)}),[],!1,null,"7672fe63").exports;export{o as P};