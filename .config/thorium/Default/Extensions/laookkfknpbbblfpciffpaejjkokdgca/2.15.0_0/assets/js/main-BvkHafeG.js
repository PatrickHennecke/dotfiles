import"./VueBase-CjPGMLuv.js";import{useFocusModeViewStateStore as e}from"./focusModeViewState-Sf_PQc_2.js";import{o}from"./oneTimeLoginService-CgWRrBJN.js";import{b as a,V as t}from"./ResizeSensor-CXS_pGRc.js";import{n as i}from"./promisifiedChrome-CheD9WtZ.js";import"./dashboard-CF_jRhAY.js";import"./main--IJuvtTE.js";import"./localStorage-B4mFdj8F.js";import"./preload-helper-D7CfCCEq.js";import"./Logger-Dqn8sDPg.js";import"./environmentVariables-Cy83xda0.js";import"./migrateLegacyUserMessageHandler-CU6TUnqH.js";import"./timestampDb-sTUCijT1.js";import"./index-CJJH83pl.js";import"./ViewState-CkTFc_ep.js";import"./focusModeHelpers-Cqkll3ju.js";import"./reactiveCustomization-CrL2eTrh.js";import"./siteBlockerViewState-BRcSSYc9.js";import"./string-KTo4Qfpe.js";import"./authService-B5VliZ3K.js";import"./SubscriptionSummary-Bb_CwKvU.js";const r={name:"Background",setup:()=>({focusModeViewStateStore:e()}),data:()=>({imageUrl:"",transitionSpeed:"fade",loadingImage:!1}),computed:{imagePseudoElementContent(){return this.focusModeViewStateStore.backgroundBlurLayerVisible?'""':void 0},transitionDuration(){return this.focusModeViewStateStore.backgroundTransitionDuration?this.focusModeViewStateStore.backgroundTransitionDuration+"ms":"var(--a-show-full-duration)"}},created(){m.models.activeBackground.on("background:activeChanged",this.setBackground),m.on("image:loaded",this.imageLoaded),m.on("image:error",this.imageError),m.on("image:timeout",this.imageTimeout),m.on("topics:open",this.addOverlay),m.on("topics:closed",this.removeOverlay),m.models.backgroundManager.backgroundItem?this.setBackground(m.models.backgroundManager.backgroundItem):m.models.activeBackground.backgroundItem&&this.setBackground(m.models.activeBackground.backgroundItem)},destroyed(){m.models.activeBackground.off("background:activeChanged",this.setBackground),m.off("image:loaded",this.imageLoaded),m.off("image:error",this.imageError),m.off("image:timeout",this.imageTimeout),m.off("topics:open",this.addOverlay),m.off("topics:closed",this.removeOverlay)},methods:{setBackground(e){this.loadingImage=!0,this.imageUrl&&(this.transitionSpeed="fade-slow");const o=e.get("isBuiltIn"),a=e.backgroundUuid(),t=e.get("filename");"true"==localStorage.getItem("failed:"+t)&&m.models.activeBackground.trigger("background:fallback");const i={uuid:a,url:t,height:e.get("height"),width:e.get("width"),skip_check:e.get("skip_check")};m.models.imageManager.loadImage(i,o||this.isBackgroundLoaded?null:4e3,!1)||(this.isBackgroundLoaded?m.trigger("background:error",a):m.models.activeBackground.trigger("background:fallback"))},imageLoaded(e,a,t,i){i||(m.models.activeBackground.successfullyLoaded(e),this.isBackgroundLoaded=!0,this.loadingImage=!1,this.imageUrl=a,m.widgetManager.appReady("background",o.oneTimeLoginInProgress),o.oneTimeLoginInProgress||setTimeout(m.widgetManager.checkWidgetTimeout.bind(m.widgetManager),500),m.trigger("background:loadSuccessful",e))},imageError(e){this.loadingImage?m.models.activeBackground.trigger("background:fallback"):m.trigger("background:error",e)},imageTimeout(){this.loadingImage&&m.models.activeBackground.trigger("background:fallback")},addOverlay(){m.utils.addClass(document.body,"show-full-overlay"),this.$nextTick((()=>{m.utils.addClass(document.body,"show-full-overlay-active")}))},removeOverlay(){m.utils.removeClass(document.body,"show-full-overlay-active"),this.$nextTick((()=>{m.utils.removeClass(document.body,"show-full-overlay")}))}}},s=()=>{a(((e,o)=>({"2079b30e":e.transitionDuration,afef548e:e.focusModeViewStateStore.backgroundScale,a5f6a6de:e.imagePseudoElementContent,"72a957b2":e.focusModeViewStateStore.backgroundBlurLayerOpacity})))},d=r.setup;r.setup=d?(e,o)=>(s(),d(e,o)):s;const n=i(r,(function(){var e=this,o=e._self._c;return o("div",{staticClass:"backgrounds"},[o("div",{staticClass:"background"},[o("transition",{attrs:{name:e.transitionSpeed,mode:"in-out"}},[o("div",{key:e.imageUrl,staticClass:"background-item",style:{"background-image":"url("+e.imageUrl+")"},attrs:{"data-test":"background-item"}})])],1),o("div",{staticClass:"background-overlay"})])}),[],!1,null,"953fec02").exports;new t({render:e=>e(n)}).$mount(".backgrounds");