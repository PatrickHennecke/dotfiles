import{_ as e,a as t,b as s,c as o,d as r,e as i,f as c,g as a,h as n,i as d}from"./google-DKPAcOmk.js";import{S as h}from"./SoftFocus-BUhesXB-.js";import{a as l}from"./allComponentsMounted-C3UsG_cA.js";import{n as u,u as p,A as f}from"./promisifiedChrome-CheD9WtZ.js";import{B as v}from"./BaseDropdown-BAkdZe-R.js";import{B as g}from"./BaseDropdownText-JuRMaT4M.js";import{B as S}from"./BaseDropdownOption-CckvXbkm.js";import{_ as w}from"./icon-down-BiHbKN-t.js";const P={widget:!0,esm:!0,waitFor:!0,autoLoad:!0,id:"search",class:"app-container search",region:"top-left",addin:"162b82d0-f285-427c-8209-924f44ef4d21",visibleSetting:"searchVisible"},b=new f({feature:"search"});const I=u({name:"SearchInput",components:{BaseDropdownOption:S,BaseDropdownText:g,BaseDropdown:v},directives:{SoftFocus:h},mixins:[l],searchProviders:{google:{id:"google",name:"Google",iconSrc:e,iconWhiteSrc:t,searchId:"google-generic",prefix:"https://www.google.com/search?q="},bing:{id:"bing",name:"Bing",iconSrc:s,iconWhiteSrc:o,searchId:"bing-app-1",prefix:"https://www.bing.com/search?q=",suffix:"&PC=ATMM&FORM=MMXT01"},duckduckgo:{id:"duckduckgo",name:"DuckDuckGo",iconSrc:r,iconWhiteSrc:i,searchId:"duckduckgo",prefix:"https://duckduckgo.com/?q="},ecosia:{id:"ecosia",name:"Ecosia",iconSrc:c,iconWhiteSrc:a,searchId:"ecosia",prefix:"https://www.ecosia.org/search?q=",suffix:"&tt=c4ccf3a1"}},props:{bigSearch:{type:Boolean,default:!1},placeholder:{type:String,default:""}},unreactive:()=>({aiToolTipText:`Ask AI (${p.getMetaKeyName()} + Enter)`}),data:()=>({selectedProviderId:m.models.customization.get("searchProvider"),searchInput:"",inputHasFocus:!1}),computed:{selectedProviderIcon(){return this.$touch&&!this.bigSearch?this.selectedProvider.iconSrc:this.selectedProvider.iconWhiteSrc},selectedProvider(){return this.$options.searchProviders[this.selectedProviderId]},searchUrl(){return`${this.selectedProvider.prefix}${encodeURIComponent(this.searchInput)}${this.selectedProvider.suffix||""}`},location(){return this.bigSearch?"center":"top left"},hasInputLength(){return!!this.searchInput.length}},watch:{selectedProvider(){b.capture("search provider switch",{location:this.location,new_value:this.selectedProvider.name.toLowerCase()})}},created(){m.on("globalEvent:esc",this.blurSearch),m.on("globalEvent:toggleSearch",this.focusSearchOnUserAction),m.models.customization.on("change:searchProvider",this.setSearchProvider)},destroyed(){m.off("globalEvent:esc",this.blurSearch),m.off("globalEvent:toggleSearch",this.focusSearchOnUserAction),m.models.customization.off("change:searchProvider",this.setSearchProvider)},methods:{selectProvider(e){m.models.customization.save("searchProvider",e),this.selectedProviderId=e,this.hideDropdown(),this.focusSearch()},setSearchProvider(){this.selectedProviderId=m.models.customization.get("searchProvider")},focusSearch(){this.$refs.input.focus()},focusSearchOnDropdownCloseIfTouch(e){!e&&this.$touch&&this.$refs.input&&this.focusSearch()},focusSearchOnUserAction(e){this.inputHasFocus||(this.focusSearch(),b.capture("search focus",{location:this.location,provider:this.selectedProvider.name.toLowerCase(),method:e instanceof PointerEvent?"click":"hotkey"})),this.inputHasFocus=!0},blurSearch(){this.$refs.input.blur()},hideDropdown(){this.$refs.dropdown.closeDropdown()},submit(e,t=e.metaKey){this.hasInputLength&&(t&&this.bigSearch?(this.$emit("showChatPopup",this.searchInput),this.searchInput=""):this.selectedProvider&&this.selectedProvider.prefix&&(window.location.href=this.searchUrl,b.capture("search submit",{location:this.location,provider:this.selectedProvider.name.toLowerCase()})))},sendStartTypingEvent({inputType:e}){1===this.searchInput.length&&"insertText"===e&&b.capture("search start typing",{location:this.location,provider:this.selectedProvider.name.toLowerCase()})}}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"search-form"},[t("div",{staticClass:"search-underline"}),t("div",{staticClass:"search-icon-container"},[t("inline-svg",{staticClass:"icon dash-icon icon-search",attrs:{src:(e.bigSearch,n),"data-test":"icon-search"}})],1),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.searchInput,expression:"searchInput",modifiers:{trim:!0}},{name:"soft-focus",rawName:"v-soft-focus",value:e.$touch,expression:"$touch"}],ref:"input",staticClass:"search-input",attrs:{id:"search-input","search-url":e.searchUrl,type:"text",autocomplete:"off","data-test":"search-input",placeholder:e.placeholder},domProps:{value:e.searchInput},on:{click:e.focusSearchOnUserAction,blur:[function(t){e.inputHasFocus=!1},function(t){return e.$forceUpdate()}],input:[function(t){t.target.composing||(e.searchInput=t.target.value.trim())},e.sendStartTypingEvent],keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit.apply(null,arguments)}}}),t("div",{staticClass:"right-wrapper"},[t("transition",{attrs:{name:"fade-fast"}},[e.bigSearch&&e.searchInput?t("div",{staticClass:"ask-ai",attrs:{title:e.aiToolTipText},on:{click:function(t){return e.submit(t,!0)}}},[t("inline-svg",{staticClass:"icon icon-ai",attrs:{src:d}})],1):e._e()]),t("base-dropdown",{ref:"dropdown",staticClass:"more source",attrs:{"container-class":"dash","position-offset":10},on:{toggle:e.focusSearchOnDropdownCloseIfTouch},scopedSlots:e._u([{key:"toggle",fn:function(){return[t("div",{staticClass:"source-toggle",attrs:{tabindex:"0","data-test":"provider-toggle"}},[t("div",{staticClass:"source-selected"},[t("img",{key:e.selectedProvider.id,class:[`icon-${e.selectedProvider.id} icon icon-source`,"active"],attrs:{src:e.selectedProviderIcon}})]),t("inline-svg",{staticClass:"icon icon-dropdown",attrs:{src:w}})],1)]},proxy:!0}])},[t("base-dropdown-text",[e._v("Search with")]),e._l(e.$options.searchProviders,(function(s,o){return t("base-dropdown-option",{key:o,attrs:{"data-test":`select-${s.id}`,"data-provider":s.id},on:{click:function(t){return e.selectProvider(s.id)}}},[t("inline-svg",{staticClass:"icon icon-provider",attrs:{src:s.iconSrc}}),t("span",[e._v(e._s(s.name))])],1)}))],2)],1)])}),[],!1,null,"4dd8a0b0").exports;export{I as S,P as m};