const __vite__fileDeps=["assets/js/WeatherApp-DszlU6in.js","assets/js/preload-helper-D7CfCCEq.js","assets/js/BaseIcon-CACrCBea.js","assets/js/arrow-B0GpGOd-.js","assets/js/icon-weather-reset-D7qA-OAP.js","assets/js/icon-settings-Bycjf8-G.js","assets/js/dashboard-CF_jRhAY.js","assets/js/main--IJuvtTE.js","assets/js/ResizeSensor-CXS_pGRc.js","assets/js/environmentVariables-Cy83xda0.js","assets/js/promisifiedChrome-CheD9WtZ.js","assets/js/timestampDb-sTUCijT1.js","assets/js/Logger-Dqn8sDPg.js","assets/js/string-KTo4Qfpe.js","assets/js/localStorage-B4mFdj8F.js","assets/js/migrateLegacyUserMessageHandler-CU6TUnqH.js","assets/css/dashboard-C0DDMXTO.css","assets/js/icon-chrome-BdhFuvxf.js","assets/js/icon-back-arrow-CiRQJ6G-.js","assets/js/icon-back-D_TFrgyJ.js","assets/js/icon-check-Vc9B11BJ.js","assets/js/icon-circle-D-D5U4qS.js","assets/js/icon-close-BUGl_M7j.js","assets/js/icon-cog-BFr_Pva7.js","assets/js/icon-skip-BOkC5L0N.js","assets/js/icon-trash-DFxJwJNo.js","assets/js/icon-down-BiHbKN-t.js","assets/js/icon-edit-CixeXNYx.js","assets/js/icon-ellipsis-D3jS4u3x.js","assets/js/icon-error-state-BKQhfBCj.js","assets/js/icon-heart-v5O7C6eS.js","assets/js/icon-hide-NFfBhfBx.js","assets/js/icon-key-BPNRipb3.js","assets/js/icon-lock-B0ekkj2F.js","assets/js/icon-next-B4hjdiAA.js","assets/js/icon-photo-BrwqV1T0.js","assets/js/icon-pin-BHeOuzvO.js","assets/js/icon-plus-D4YOesIc.js","assets/js/icon-profile-B_XWyuTb.js","assets/js/icon-x-qUCmf2CW.js","assets/js/icon-skip-intro-BUi8b3Ak.js","assets/js/icon-tooltip-CN09iXOB.js","assets/js/icon-visible-on-CM3kpcFN.js","assets/js/icon-x-caret-half-CZtcH_PM.js","assets/js/star-rating-CNohptmf.js","assets/js/pomodoro-circle-Dx_GWql1.js","assets/js/star-KworSO8x.js","assets/js/thanks-DfYnO-qW.js","assets/js/add-COIuonao.js","assets/js/google-DKPAcOmk.js","assets/js/arrow-up-1QPpu78M.js","assets/js/chevron-down-DdbU9YAr.js","assets/js/pomodoro-DvfTwCi0.js","assets/js/clocks-DjzskNOU.js","assets/js/close-D7GCNZxm.js","assets/js/search-DCqlmJx6.js","assets/js/folder-CwWTWsnJ.js","assets/js/switch-EuBTQVVE.js","assets/js/focus-mode-09pIyYAW.js","assets/js/storage-YYEO5TB5.js","assets/js/icon-confetti-Dz2LojDe.js","assets/js/wind-D3u4taeq.js","assets/js/sparks-CAw9b6ob.js","assets/js/secure-B8YP-AML.js","assets/js/icon-percent-schedule-CA5EI9b7.js","assets/js/icon-trello-BoqqWb7o.js","assets/js/icon-clean-rFsPxTtp.js","assets/js/icon-more-lists-Dg-hN7s6.js","assets/js/icon-more-fonts-CcfOY0t4.js","assets/js/icon-focus-stats-keERwXFt.js","assets/js/icon-easy-access-BZifTR0C.js","assets/js/icon-top-of-mind-B6EhbCcK.js","assets/js/icon-flow-5QqmGIWX.js","assets/js/icon-focused-JrsBbR-K.js","assets/js/icon-weather-extra-ufLpT_SX.js","assets/js/icon-spiral-gh4hwZDD.js","assets/js/icon-happy-place-D1z6CJgM.js","assets/js/icon-time-sensitive-CP2L3maw.js","assets/js/icon-hourly-CdMmiQZT.js","assets/js/icon-infinity-D4yMRoAd.js","assets/js/icon-integrations-Y-aXZTst.js","assets/js/icon-kanban-Dodqg7y-.js","assets/js/icon-personalize-photos-D2M4lLlt.js","assets/js/icon-personalize-n8qjJGGA.js","assets/js/icon-photo-match-C2EChNEK.js","assets/js/icon-random-375DbcwF.js","assets/js/icon-timezones-DGZoTtaT.js","assets/js/icon-simplify-BRUtLJYp.js","assets/js/icon-skip-Bd6EhalI.js","assets/js/icon-sync-DIH26Y9h.js","assets/css/BaseIcon-BlT7Qz-y.css","assets/js/SmoothReflow-B3dWZqEj.js","assets/js/allComponentsMounted-C3UsG_cA.js","assets/css/SmoothReflow-DiGQ1RDg.css","assets/js/reactiveCustomization-CrL2eTrh.js","assets/js/VueBase-CjPGMLuv.js","assets/js/index-CJJH83pl.js","assets/js/Dropdown-CPB6qe0h.js","assets/css/Dropdown-BcLAxJWG.css","assets/js/AppPopup-D_ukOJBQ.js","assets/js/globalKeyEventManager-KbJZwtdf.js","assets/css/AppPopup-CS-R--Nx.css","assets/js/AppContainer-CpKUTdzh.js","assets/js/showAnyway-CbfR58eh.js","assets/css/AppContainer-Okwrv5EP.css","assets/js/AppDash-DWWhxnHq.js","assets/css/AppDash-ISNkhJBP.css","assets/js/hideEventsMixin-C3v17jdv.js","assets/js/appToggleMixin-IV4cErk-.js","assets/js/ViewState-CkTFc_ep.js","assets/css/WeatherApp-DU5rNCgD.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import"./VueBase-CjPGMLuv.js";import{_ as e}from"./preload-helper-D7CfCCEq.js";import{j as t,k as o,l as i,m as s,n as a,o as r,p as n,q as c,r as l,s as u,t as d,u as h,v as p,w as g,x as w,y as v}from"./BaseIcon-CACrCBea.js";import{V as y,v as f}from"./ResizeSensor-CXS_pGRc.js";import{p as S,c as b}from"./reactiveCustomization-CrL2eTrh.js";import{r as T,A as L,n as j}from"./promisifiedChrome-CheD9WtZ.js";import I from"./AppContainer-CpKUTdzh.js";import{A as C}from"./AppDash-DWWhxnHq.js";import{s as N}from"./showAnyway-CbfR58eh.js";import{h as O}from"./hideEventsMixin-C3v17jdv.js";import{a as A}from"./appToggleMixin-IV4cErk-.js";import{u as D}from"./ViewState-CkTFc_ep.js";const z={tornado:"wind",tropicalStorm:"wind",hurricane:"wind",severeThunderstorm:"severeStorm",thunderstorm:"storm",mixedRainAndSnow:"hail",drizzle:"drizzle",rain:"rain",freezingRain:"hail",showers:"drizzle",sunnyShowers:"drizzle",snowFlurries:"lightSnow",snow:"snow",hail:"hail",sleet:"hail",dust:"fog",foggy:"fog",haze:"fog",smoky:"fog",blustery:"wind",windy:"wind",cold:"cold",cloudy:"cloudy",mostlyCloudyNight:"cloudyNight",mostlyCloudyDay:"cloudyDay",partlyCloudyNight:"cloudyNight",partlyCloudyDay:"cloudyDay",clearNight:"clearNight",clearDay:"clearDay",scatteredThunderstorm:"storm",scatteredShowers:"drizzle",heavySnow:"snow",thundershowers:"storm",snowShowers:"snow",unknown:"unknown"},M={speed:{metricToImperial:.62137,imperialToMetric:1.60934},pressure:{metricToImperial:.02953,imperialToMetric:33.86309},shortLength:{metricToImperial:.03937,imperialToMetric:25.4},longLength:{metricToImperial:.62137,imperialToMetric:1.60934}};function R(e,t){return t?Math.round(5*(e-32)/9):e}function x(e,t,o){const i=o?{pressure:"kPa",speed:"km/h",shortLength:"mm",longLength:"km"}:{pressure:"inHg",speed:"mph",shortLength:"in",longLength:"mi"};return o?Math.round(t*M[e].imperialToMetric)+" "+i[e]:Math.round(t)+" "+i[e]}function V(e){return function(e){switch(e){case"../../../img/meteocons/clearDay":case"../../../img/meteocons/clearDay.svg":return v;case"../../../img/meteocons/clearNight":case"../../../img/meteocons/clearNight.svg":return w;case"../../../img/meteocons/cloudy":case"../../../img/meteocons/cloudy.svg":return g;case"../../../img/meteocons/cloudyDay":case"../../../img/meteocons/cloudyDay.svg":return p;case"../../../img/meteocons/cloudyNight":case"../../../img/meteocons/cloudyNight.svg":return h;case"../../../img/meteocons/cold":case"../../../img/meteocons/cold.svg":return d;case"../../../img/meteocons/drizzle":case"../../../img/meteocons/drizzle.svg":return u;case"../../../img/meteocons/fog":case"../../../img/meteocons/fog.svg":return l;case"../../../img/meteocons/hail":case"../../../img/meteocons/hail.svg":return c;case"../../../img/meteocons/lightSnow":case"../../../img/meteocons/lightSnow.svg":return n;case"../../../img/meteocons/rain":case"../../../img/meteocons/rain.svg":return r;case"../../../img/meteocons/severeStorm":case"../../../img/meteocons/severeStorm.svg":return a;case"../../../img/meteocons/snow":case"../../../img/meteocons/snow.svg":return s;case"../../../img/meteocons/storm":case"../../../img/meteocons/storm.svg":return i;case"../../../img/meteocons/unknown":case"../../../img/meteocons/unknown.svg":return o;case"../../../img/meteocons/wind":case"../../../img/meteocons/wind.svg":return t;default:throw new Error("Cann't found module: "+e)}}(`../../../img/meteocons/${z[e]}.svg`)}function _(e){return e=parseInt(e.substr(e.indexOf("T")+1,2)),S.hour12clock?(e>12?e-12:0===e?12:e)+(e<12?"AM":"PM"):e+""}function k(e){let t={rain:e.rainProbability,ice:e.iceProbability,snow:e.snowProbability},o="rain",i=0;return Object.entries(t).forEach((([e,t])=>{t>i&&(o=e,i=t)})),{type:m.utils.capitalizeWords(o),chance:i}}class P{constructor(e,t){e&&e.now&&(this.metric="f"!==t,this.location=e.location,this.now=Object.assign({},e.now,{temperature:R(e.now.temperature,this.metric),icon:V(e.now.code),apparentTemperature:R(e.now.apparentTemperature,this.metric),windGust:x("speed",e.now.windGust,this.metric),windSpeed:x("speed",e.now.windSpeed,this.metric),precipitationType:e.now.hasPrecipitation?e.now.precipitationType:"Rain",precipAmount6Hours:x("shortLength",e.now.precipAmount6Hours,this.metric)}))}}class E extends P{constructor(e,t){super(e,t),e&&e.now&&(this.now=Object.assign({},e.now,this.now,{precipAmount:x("shortLength",e.now.precipAmount,this.metric),temperature:R(e.now.temperature,this.metric),visibility:x("longLength",e.now.visibility,this.metric),sunrise:e.now.sunrise?m.utils.getHoursMinsStr(new Date(e.now.sunrise)):"AM",sunset:e.now.sunset?m.utils.getHoursMinsStr(new Date(e.now.sunset)):"PM",pressure:x("pressure",parseFloat(e.now.pressure),this.metric),pressureChanging:"Steady"!==e.now.pressureTendency,pressureRotation:"Falling"===e.now.pressureTendency?180:0,precipitationChance:k(e.now)}),e.hours&&e.days&&(this.hours=e.hours.map((e=>Object.assign({},e,{apparentTemperature:R(e.apparentTemperature,this.metric),temperature:R(e.temperature,this.metric),windGust:x("speed",e.windGust,this.metric),windSpeed:x("speed",e.windSpeed,this.metric),icon:V(e.code),hour:_(e.hour)}))),this.days=e.days.map((e=>Object.assign({},e,{apparentHigh:R(e.apparentHigh,this.metric),apparentLow:R(e.apparentLow,this.metric),high:R(e.high,this.metric),low:R(e.low,this.metric),windGust:x("speed",e.windGust,this.metric),windSpeed:x("speed",e.windSpeed,this.metric),icon:V(e.code),precipitationChance:k(e)})))))}}const U="weather:forecast",F="weather:location",H="detailLastUpdated",W="baseLastUpdated",G="weather:nextUpdate",$=new(y.extend({name:"WeatherDataService",data:()=>({conditionsRaw:localStorage.getObject(U),manualLocation:localStorage.getObject(F),detailed:!1,noConnection:!1,loading:!1}),unreactive:()=>({refreshTimeoutId:null}),computed:{conditions(){return this.conditionsRaw?new(this.detailed?E:P)(this.conditionsRaw,S.temperatureUnit):null},locationName(){var e,t;return(null==(e=this.manualLocation)?void 0:e.shortName)||(null==(t=this.conditions)?void 0:t.location.locationName)},tabVisible:()=>T.tabVisible},watch:{conditionsRaw(e){e&&localStorage.setObject(U,e),this.setRefreshTimeout()},tabVisible(e){e?this.setRefreshTimeout():clearTimeout(this.refreshTimeoutId)},detailed(e){e&&this.refreshIfOutdated()}},created(){!function(){const e=localStorage.getObject("weather-manual");e&&(localStorage.setObject("weather:location",{latitude:e.latitude,longitude:e.longitude,name:e.locationName,shortName:e.locationName}),localStorage.removeItem("weather-manual")),localStorage.removeItem("weather")}(),window.addEventListener("storage",this.onStorageEvent),this.setRefreshTimeout()},methods:{setLocation(e){JSON.stringify(this.manualLocation)!==JSON.stringify(e)&&(e?localStorage.setObject(F,e):localStorage.removeItem(F),this.manualLocation=e,this.refreshFromServer())},setDetailLevel(e){this.detailed=e},onStorageEvent(e){var t;const o=e=>e&&JSON.parse(e);if((null==e?void 0:e.key)===U&&(null==e?void 0:e.newValue)){const i=o(e.newValue);i[W]>((null==(t=this.conditionsRaw)?void 0:t[W])||0)&&(this.conditionsRaw=i)}else(null==e?void 0:e.key)===F&&(this.manualLocation=o(e.newValue))},getLastUpdated(){const e=localStorage.getObject(U);return e?parseInt(e[this.detailed?H:W]||0):0},getTimeToNextUpdate(){const e=parseInt(localStorage.getItem(G)),t=Date.now(),o=18e5-(t-this.getLastUpdated());return e?Math.max(e-t,o,0):Math.max(o,0)},refreshIfOutdated(){this.getTimeToNextUpdate()<=0&&this.tabVisible&&this.refreshFromServer()},setRefreshTimeout(){clearTimeout(this.refreshTimeoutId),this.refreshTimeoutId=setTimeout(this.refreshIfOutdated,this.getTimeToNextUpdate())},async refreshFromServer(){const e=this.detailed;if(this.loading)return;this.loading=!0;let t="weather/"+(e?"forecast":"current");this.manualLocation&&(t+=`?lat=${this.manualLocation.latitude}&lon=${this.manualLocation.longitude}`);try{const{data:o}=await this.$xhr.get(t),i=Date.now();o[W]=i,e&&(o[H]=i),localStorage.removeItem(G),this.conditionsRaw=Object.assign({},this.conditionsRaw||{},o),this.noConnection=!1}catch(o){console.error(o);const e=o.response;e&&429===e.status&&e.headers["retry-after"]?(localStorage.setItem(G,Date.now()+1e3*parseInt(e.headers["retry-after"])),this.setRefreshTimeout()):this.noConnection=!0}finally{this.loading=!1}}}})),q=D("weather"),J=new L({feature:"weather"});const B=j({name:"Weather",components:{WeatherApp:()=>e((()=>import("./WeatherApp-DszlU6in.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110])),AppDash:C,AppContainer:I},mixins:[O({appKey:"weather",hideEvents:["globalEvent:toggle:bottom-left","globalEvent:toggle:bottom-right","globalEvent:toggle:top-right"],closeFunctionName:"closePopup",eventTriggerProperty:"popupActive"}),A({useViewStateStore:q,analytics:J})],provide(){return{viewStateStore:this.weatherViewStateStore}},computed:{conditions:()=>$.conditions,location:()=>$.locationName||"Weather",svgIcon(){var e,t;return(null==(t=null==(e=this.conditions)?void 0:e.now)?void 0:t.icon)||p},weatherVisible:()=>b.weatherVisible,showAnyway:()=>N.includes("weather"),detailedLevelVisible(){return this.$plus&&this.popupActive},...f(q)},watch:{detailedLevelVisible(){$.setDetailLevel(this.detailedLevelVisible)}},mounted(){m.widgetManager.appReady("weather")}},(function(){var e=this,t=e._self._c;return t("app-container",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.closePopup,expression:"closePopup"}],attrs:{"visible-setting":"weatherVisible","app-name":"weather",hotkey:"W","data-test":"weather",overlay:e.popupActive},on:{toggle:e.togglePopupAndCaptureIfOpen}},[t("app-dash",{staticClass:"metric-item",on:{click:function(t){return e.togglePopupAndCaptureIfOpen({source:"click"})}}},[t("div",{staticClass:"metric-stat"},[t("div",{staticClass:"current-icon"},[t("inline-svg",{staticClass:"icon",attrs:{src:e.svgIcon}})],1),e.conditions?t("div",{staticClass:"current-temp",attrs:{"data-test":"temperature"}},[e._v(" "+e._s(e.conditions.now.temperature+"°")+" ")]):e._e()]),t("div",{staticClass:"metric-label"},[t("span",{staticClass:"metric-label-name",attrs:{"data-test":"location"}},[e._v(e._s(e.location))])])]),t("transition",{attrs:{name:"slide-down-fade"}},[e.popupActive?t("weather-app",{on:{close:e.closePopup}}):e._e()],1)],1)}),[],!1,null,"434ecec1").exports,K=document.querySelector(".region.top-right"),Q=document.createElement("div");K.prepend(Q),new y({render:e=>e(B)}).$mount(Q);const X=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{X as m,$ as w};