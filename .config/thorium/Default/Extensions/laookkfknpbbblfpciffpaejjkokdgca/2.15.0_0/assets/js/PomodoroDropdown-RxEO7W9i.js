import t from"./Dropdown-CPB6qe0h.js";import o from"./DropdownOption-CokACERR.js";import s from"./ToastMenuLegacy-Do47o3MR.js";import i from"./QuickNavOptionsList-B0pawPd9.js";import{n as e,i as r,A as n}from"./promisifiedChrome-CheD9WtZ.js";import{B as a}from"./BaseIcon-CACrCBea.js";import{b as c}from"./icon-weather-reset-D7qA-OAP.js";import{_ as p}from"./icon-circle-D-D5U4qS.js";import"./icon-ellipsis-D3jS4u3x.js";import"./timestampDb-sTUCijT1.js";import"./Logger-Dqn8sDPg.js";import"./environmentVariables-Cy83xda0.js";import"./ResizeSensor-CXS_pGRc.js";import"./preload-helper-D7CfCCEq.js";import"./string-KTo4Qfpe.js";import"./arrow-B0GpGOd-.js";import"./icon-settings-Bycjf8-G.js";import"./dashboard-CF_jRhAY.js";import"./main--IJuvtTE.js";import"./localStorage-B4mFdj8F.js";import"./migrateLegacyUserMessageHandler-CU6TUnqH.js";import"./icon-chrome-BdhFuvxf.js";import"./icon-back-arrow-CiRQJ6G-.js";import"./icon-back-D_TFrgyJ.js";import"./icon-check-Vc9B11BJ.js";import"./icon-close-BUGl_M7j.js";import"./icon-cog-BFr_Pva7.js";import"./icon-skip-BOkC5L0N.js";import"./icon-trash-DFxJwJNo.js";import"./icon-down-BiHbKN-t.js";import"./icon-edit-CixeXNYx.js";import"./icon-error-state-BKQhfBCj.js";import"./icon-heart-v5O7C6eS.js";import"./icon-hide-NFfBhfBx.js";import"./icon-key-BPNRipb3.js";import"./icon-lock-B0ekkj2F.js";import"./icon-next-B4hjdiAA.js";import"./icon-photo-BrwqV1T0.js";import"./icon-pin-BHeOuzvO.js";import"./icon-plus-D4YOesIc.js";import"./icon-profile-B_XWyuTb.js";import"./icon-x-qUCmf2CW.js";import"./icon-skip-intro-BUi8b3Ak.js";import"./icon-tooltip-CN09iXOB.js";import"./icon-visible-on-CM3kpcFN.js";import"./icon-x-caret-half-CZtcH_PM.js";import"./star-rating-CNohptmf.js";import"./pomodoro-circle-Dx_GWql1.js";import"./star-KworSO8x.js";import"./thanks-DfYnO-qW.js";import"./add-COIuonao.js";import"./google-DKPAcOmk.js";import"./arrow-up-1QPpu78M.js";import"./chevron-down-DdbU9YAr.js";import"./pomodoro-DvfTwCi0.js";import"./clocks-DjzskNOU.js";import"./close-D7GCNZxm.js";import"./search-DCqlmJx6.js";import"./folder-CwWTWsnJ.js";import"./switch-EuBTQVVE.js";import"./focus-mode-09pIyYAW.js";import"./storage-YYEO5TB5.js";import"./icon-confetti-Dz2LojDe.js";import"./wind-D3u4taeq.js";import"./sparks-CAw9b6ob.js";import"./secure-B8YP-AML.js";import"./icon-percent-schedule-CA5EI9b7.js";import"./icon-trello-BoqqWb7o.js";import"./icon-clean-rFsPxTtp.js";import"./icon-more-lists-Dg-hN7s6.js";import"./icon-more-fonts-CcfOY0t4.js";import"./icon-focus-stats-keERwXFt.js";import"./icon-easy-access-BZifTR0C.js";import"./icon-top-of-mind-B6EhbCcK.js";import"./icon-flow-5QqmGIWX.js";import"./icon-focused-JrsBbR-K.js";import"./icon-weather-extra-ufLpT_SX.js";import"./icon-spiral-gh4hwZDD.js";import"./icon-happy-place-D1z6CJgM.js";import"./icon-time-sensitive-CP2L3maw.js";import"./icon-hourly-CdMmiQZT.js";import"./icon-infinity-D4yMRoAd.js";import"./icon-integrations-Y-aXZTst.js";import"./icon-kanban-Dodqg7y-.js";import"./icon-personalize-photos-D2M4lLlt.js";import"./icon-personalize-n8qjJGGA.js";import"./icon-photo-match-C2EChNEK.js";import"./icon-random-375DbcwF.js";import"./icon-timezones-DGZoTtaT.js";import"./icon-simplify-BRUtLJYp.js";import"./icon-skip-Bd6EhalI.js";import"./icon-sync-DIH26Y9h.js";const l=new n({feature:"pomodoro",is_paid_event:!0});const d=e({name:"PomodoroDropdown",doNotWaitForMount:!0,components:{QuickNavOptionsList:i,Dropdown:t,DropdownOption:o,ToastMenu:s,BaseIcon:a},props:{timers:{type:Object,default:()=>({})},sounds:{type:Boolean,default:!1},browserNotifications:{type:Boolean,default:!1},autoplay:{type:Boolean,default:!1},hideSeconds:{type:Boolean,default:!1},completedStats:{type:Object,default:()=>({})},options:{type:Object,default:()=>({})},alwaysOpen:{type:Boolean,default:!1}},setup:()=>({periods:{today:"Today",week:"This Week",allTime:"All Time"}}),data(){return{active:!1,restDuration:this.timers.rest.minutes,originalRestDuration:this.timers.rest.minutes,focusDuration:this.timers.focus.minutes,originalFocusDuration:this.timers.focus.minutes,period:"today"}},computed:{isSafari:r,dropdownComponent(){return this.alwaysOpen?"div":this.$touch?s:t},completedStatsPeriod(){return this.periods[this.period]},completedCounts(){return this.completedStats.counts?this.completedStats.counts[this.period]:0},completedFocusedTime(){const t=this.completedStats.focusedMinutes&&this.completedStats.focusedMinutes[this.period];if(!t)return"0m";let o=Math.trunc(t/60);const s=Math.trunc(o/24);let i=t;return s>=1?(o-=24*s,i=t-24*s*60-60*o):o>=1&&(i=t-60*o),i%1!=0&&(i=i.toFixed(2)),`${s?`${s}d`:""} ${o?`${o}h`:""} ${i?`${i}m`:""}`}},watch:{restDuration(t){this.validateTimerDuration(t,"rest")},focusDuration(t){this.validateTimerDuration(t,"focus")},"timers.focus.minutes"(t){this.focusDuration=t},"timers.rest.minutes"(t){this.restDuration=t}},created(){this.$e.$on("pomodoro:toggleDropdown",this.toggleDropdown)},destroyed(){this.$e.$off("pomodoro:toggleDropdown",this.toggleDropdown)},methods:{async updateSetting(t,o){switch(t){case"autoplay":l.capture("autoplay toggle",{new_value:o});break;case"hideSeconds":l.capture("calm timer toggle",{new_value:o});break;case"browserNotifications":if(o)return this.$emit("ensureNotificationPermissions")}this.$emit("update:"+t,o)},toggleDropdown(t=!this.active){this.active=t},resetDurationIfNeeded(t){const o=`${t}Duration`,s=`original${m.utils.capitalizeFirstLetter(t)}Duration`;this[o]?this[s]=this[o]:this[o]=this[s]},validateTimerDuration(t,o){const s=`${o}Duration`;t&&""!==t&&t<=0&&(this[s]=1),t&&""!==t&&this.$emit("update:timer",o,Number(this[s]))},cycleTroughPeriods(){const t=Object.keys(this.periods),o=t.findIndex((t=>t===this.period)),s=2===o?0:o+1;this.period=t[s],l.capture("cycle stats")},focusRef(t){this.$refs[t]&&this.$refs[t].focus()},completeTimer(){this.$emit("complete-timer")},restartTimer(){this.$emit("restart-timer")},addTenMinutes(){this.$emit("add-ten-minutes")},switchClock(t){this.$emit("switch-clock",t)},addFocus(){this.toggleDropdown(!1),m.trigger("focus:pomodoro:new")}}},(function(){var t=this,o=t._self._c;return o(t.dropdownComponent,{tag:"component",attrs:{"on-dash":!0,active:t.active||t.alwaysOpen,"section-title":"Pomodoro Settings"},on:{toggle:t.toggleDropdown},scopedSlots:t._u([{key:"header",fn:function(){return[t.$touch?o("quick-nav-options-list",{attrs:{options:t.options,active:"pomodoro"},on:{"switch-to":t.switchClock}}):t._e()]},proxy:!0}])},[o("div",{staticClass:"stats",on:{click:t.cycleTroughPeriods}},[o("div",[o("div",{staticClass:"stats-heading"},[t._v(" Completed "),o("transition",{attrs:{mode:"out-in",name:"fade-fast"}},[o("span",{key:t.period,staticClass:"stats-heading-period"},[t._v(" "+t._s(t.completedStatsPeriod)+" "),o("inline-svg",{staticClass:"icon stats-icon",attrs:{src:c}})],1)])],1),o("div",{staticClass:"stats-row"},[o("div",{staticClass:"stats-item"},[o("div",{staticClass:"stats-label"},[t._v("Timers")]),o("transition",{attrs:{mode:"out-in",name:"fade-fast"}},[o("div",{key:t.period,staticClass:"stats-value",attrs:{"data-test":"completed-count"}},[t._v(t._s(t.completedCounts))])])],1),o("div",{staticClass:"stats-item"},[o("div",{staticClass:"stats-label"},[t._v("Focused")]),o("transition",{attrs:{mode:"out-in",name:"fade-fast"}},[o("div",{key:t.period,staticClass:"stats-value",attrs:{"data-test":"completed-time"}},[t._v(t._s(t.completedFocusedTime))])])],1)])])]),t.$touch?o("li",{staticClass:"line"}):t._e(),t.$touch?o("dropdown-option",{attrs:{name:"Add a focus","data-test":"addFocus"},nativeOn:{click:function(o){return t.addFocus.apply(null,arguments)}},scopedSlots:t._u([{key:"icon",fn:function(){return[o("base-icon",{attrs:{src:"icon/pomodoro/icon-plus",size:"13px"}})]},proxy:!0}],null,!1,1988332699)}):t._e(),o("dropdown-option",{attrs:{name:"Complete timer","data-test":"complete-timer"},nativeOn:{click:function(o){return t.completeTimer.apply(null,arguments)}},scopedSlots:t._u([{key:"icon",fn:function(){return[o("base-icon",{attrs:{src:"icon/pomodoro/icon-forward",size:"13px"}})]},proxy:!0}])}),o("dropdown-option",{attrs:{name:"Restart timer","data-test":"restart-timer"},nativeOn:{click:function(o){return t.restartTimer.apply(null,arguments)}},scopedSlots:t._u([{key:"icon",fn:function(){return[o("base-icon",{attrs:{src:"icon/pomodoro/icon-restart",size:"13px"}})]},proxy:!0}])}),o("dropdown-option",{attrs:{name:"Add 10 minutes","data-test":"extend-timer"},nativeOn:{click:function(o){return t.addTenMinutes.apply(null,arguments)}},scopedSlots:t._u([{key:"icon",fn:function(){return[o("base-icon",{attrs:{src:"icon/pomodoro/icon-plus",size:"13px"}})]},proxy:!0}])}),o("li",{staticClass:"line"}),o("li",{staticClass:"dropdown-list-item has-input",on:{click:function(o){return t.focusRef("focusDurationInput")}}},[o("span",{staticClass:"dropdown-list-label"},[t._v("Focus")]),o("span",{staticClass:"input-wrapper"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.focusDuration,expression:"focusDuration"}],ref:"focusDurationInput",staticClass:"hide-controls",attrs:{type:"number",name:"focusDuration",min:"1","data-test":"focus-input"},domProps:{value:t.focusDuration},on:{blur:function(o){return t.resetDurationIfNeeded("focus")},input:function(o){o.target.composing||(t.focusDuration=o.target.value)}}}),o("span",{staticClass:"dropdown-list-input-unit"},[t._v("min")])])]),o("li",{staticClass:"dropdown-list-item has-input",on:{click:function(o){return t.focusRef("restDurationInput")}}},[o("span",{staticClass:"dropdown-list-label"},[t._v("Break")]),o("span",{staticClass:"input-wrapper"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.restDuration,expression:"restDuration"}],ref:"restDurationInput",staticClass:"hide-controls",attrs:{type:"number",name:"restDuration",min:"1","data-test":"rest-input"},domProps:{value:t.restDuration},on:{blur:function(o){return t.resetDurationIfNeeded("rest")},input:function(o){o.target.composing||(t.restDuration=o.target.value)}}}),o("span",{staticClass:"dropdown-list-input-unit"},[t._v("min")])])]),o("li",{staticClass:"line"}),o("li",{staticClass:"dropdown-list-item has-toggle",class:{on:t.sounds},attrs:{title:"Play sounds when timers start or end","data-test":"auto-play"},on:{click:function(o){return t.updateSetting("sounds",!t.sounds)}}},[o("span",{staticClass:"dropdown-list-label"},[t._v("Pomodoro sounds")]),o("span",{staticClass:"toggle-slider"},[o("inline-svg",{staticClass:"toggle-switch",attrs:{src:p}})],1)]),o("li",{staticClass:"dropdown-list-item has-toggle",class:{on:t.autoplay},attrs:{title:"Auto-start break timer after completing focus timer","data-test":"auto-play"},on:{click:function(o){return t.updateSetting("autoplay",!t.autoplay)}}},[o("span",{staticClass:"dropdown-list-label"},[t._v("Auto-start timers")]),o("span",{staticClass:"toggle-slider"},[o("inline-svg",{staticClass:"toggle-switch",attrs:{src:p}})],1)]),o("li",{staticClass:"dropdown-list-item has-toggle",class:{on:t.hideSeconds},attrs:{title:"Hide the seconds count for a calmer timer experience","data-test":"calm-timer"},on:{click:function(o){return t.updateSetting("hideSeconds",!t.hideSeconds)}}},[o("span",{staticClass:"dropdown-list-label"},[t._v("Hide seconds")]),o("span",{staticClass:"toggle-slider"},[o("inline-svg",{staticClass:"toggle-switch",attrs:{src:p}})],1)]),t.isSafari?t._e():o("li",{staticClass:"dropdown-list-item has-toggle",class:{on:t.browserNotifications},attrs:{title:"Get notified outside of your browser when your timer ends","data-test":"os-notifications"},on:{click:function(o){return t.updateSetting("browserNotifications",!t.browserNotifications)}}},[o("span",{staticClass:"dropdown-list-label"},[t._v("Browser notifications")]),o("span",{staticClass:"toggle-slider"},[o("inline-svg",{staticClass:"toggle-switch",attrs:{src:p}})],1)])],1)}),[],!1,null,"40112b24").exports;export{d as default};